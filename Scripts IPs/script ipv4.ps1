#Pour chaque symbole mal interprété mettre un espace invisible avant ou après 
#il est entre les parenthèses (ㅤ)
$fck = "╭∩╮(･◡･)╭∩╮"
$sym  = "➵ ➳ ⇥ → ➥ ◈ ↩"
$ScriptName = $MyInvocation.MyCommand.Name
Install-Module PSWriteColor
Import-Module PSWriteColor

$text = @"
                                                            
                          ▓▓▓▓▓▓▓▓▓▓▓▓▓▓        ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓         
                         ▓▓        ▓▓▒▒▓▓      ▓▓           ▓▓▓▓        
                         ▓▓        ▓▓▒▒▒▓▓▓▓▓▓▓▓▓▓▓▓       ▓▓▒▒▓▓       
                        ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒▒▒▓▓▓     ▓▓       ▓▓▒▒▓▓       
                        ▓▓           ▓▓░░░▓▓      ▓▓      ▓▓▒▒▒▒▓▓      
                       ▓▓            ▓▓░░░▓▓     ▓▓       ▓▓▒▒▒▒▒▓▓     
                      ▓▓▓           ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒▒▒▒▒▒▒▓▓    
                      ▓▓                                 ▓▓▒▒▒▒▒▒▓▓     
                     ▓▓                                 ▓▓▒▒▒▒▒▒▒▓▓     
                     ▓▓         ▓▓▓▓▓     ▓▓▓▓▓         ▓▓▒▒▒▒▒▒▒▓▓     
                    ▓▓▓▓▓▓▓    ▓▓▒▒▓▓    ▓▓▓▓▓▓        ▓▓▒▒▒▒▒▒▒▓▓      
                   ▓▓▓   ▓▓    ▓▓▒▒▓▓   ▓▓   ▓▓        ▓▓▒▒▒▒▒▒▒▓▓      
                   ▓▓   ▓▓▓▓▓▓▓▓▒▒▒▓   ▓▓▓  ▓▓        ▓▓▒▒▒▒▒▒▒▓▓       
                  ▓▓    ▓▓    ▓▓▒▒▓▓   ▓▓   ▓▓        ▓▓▒▒▒▒▒▒▒▓▓       
                  ▓▓   ▓▓▓▓▓▓▓▓▒▒▒▓▓▓▓▓▓   ▓▓        ▓▓░░░░░░░▓▓        
                 ▓▓         ▓▓▒▒▒▒▒▒▓▓     ▓▓        ▓▓░░░░░░░▓▓        
                 ▓▓▓▓▓▓▓▓▓▓▓▓▓▒▒▒▒▒▒▒▓▓   ▓▓▓▓▓▓▓▓▓▓▓▓░░░░░░░▒▓▓        
                  ▓▓         ▓▓░░░░░░░▓▓▓            ▓▓▒░░░░░▓▓         
                   ▓▓         ▓▓▒░░░░░▓▓▓▓▓▓▓         ▓▓▓░░░░▓▓         
                    ▓▓▓        ▓▓▓░░░▓▓     ▓▓          ▓▓░░▓▓          
                      ▓▓         ▓▓░▓▓       ▓▓          ▓▓▓▓▓          
                       ▓▓▓▓▓▓▓▓▓▓▓▓▓▓         ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓           
                                                     
"@

$text2 = @"
╔═════════════════════════════════════════════════════════════════════════════════════╗ 
║                                   $ScriptName                                  ║
╚═════════════════════════════════════════════════════════════════════════════════════╝
"@

Clear-Host
Write-Host $text
Write-Host  
Write-Host $text2 

# Vérif si j'ai lancé le script en admin
$currentPrincipal = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
$ME = $currentPrincipal.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)

if ( $ME -eq $false ) {
    write-host 
    write-host -ForegroundColor Red "LE SCRIPT DOIT ETRE LANCE DANS UN POWERSHELL AVEC LES DROITS ADMINISTRATEURS"
    exit
}
else {
    write-host -NoNewline '▌ㅤScript lancé dans un shell Administrateurs ➞  '
    Write-Host -ForegroundColor Green 'OK' 
}

Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V-All
Pause
Get-AppxPackage *Microsoft.549981C3F5F10* | Remove-AppxPackage
Pause
Get-AppxPackage -AllUsers Microsoft.XboxApp | Remove-AppxPackage
Pause
Get-AppxPackage -AllUsers Microsoft.XboxGamingOverlay | Remove-AppxPackage
Pause
$webclient = New-Object -TypeName System.Net.WebClient
$webclient.DownloadFile('URL à rentrer''C:\Fichiers_à_installer')

Pause
$a =[string]
$resultata = read-host "ip"
if($resultata -eq $null) {$resultata = $a}
if($resultata -eq "") {$resultata = $a}
if($resultata.Length -igt 0) {
Write-Host "Debug1"
$a = $resultata
Write-Host "Vous avez enregistré l'ip" $a

} 
else {
Write-Host "Debug2"

}

$b =[string]
$resultatb = read-host "cidr"
if($resultatb -eq $null) {$resultatb = $b}
if($resultatb -eq "") {$resultatb = $b}
if($resultatb.Length -igt 0) {
Write-Host "Debug1"
$b = $resultatb
Write-Host "Vous avez enregistré le cidr" $b

} 
else {
Write-Host "Debug2"

}

$c =[string]
$resultatc = read-host "gateway"
if($resultatc -eq $null) {$resultatc = $c}
if($resultatc -eq "") {$resultatc = $c}
if($resultatc.Length -igt 0) {
Write-Host "Debug1"
$c = $resultatc
Write-Host "Vous avez enregistré la passerelle par defaut" $c

} 
else {
Write-Host "Debug2"

}

$d =[string]
$resultatd = read-host "DNS"
if($resultatd -eq $null) {$resultatd = $d}
if($resultatd -eq "") {$resultatd = $d}
if($resultatd.Length -igt 0) {
Write-Host "Debug1"
$d = $resultatd
Write-Host "Vous avez enregistré le DNS" $d

} 
else {
Write-Host "Debug2"

}

Pause
Get-NetIPAddress
Pause
New-NetIPAddress -IPAddress $a -DefaultGateway $c -PrefixLength $b -InterfaceAlias Ethernet
Set-DnsClientServerAddress -ServerAddresses $d -InterfaceAlias Ethernet
Pause 
Get-NetIPAddress